<% trade_item = current_organ.get_trade_item(good_type: model.class_name, good_id: model.id, aim: 'invest') %>

<% if trade_item %>
  <%= button_to({ controller: 'trade/my/trade_items', action: 'update', id: trade_item.id }, method: :patch, params: { '[trade_item]number': trade_item.number - 1 }, class: 'mr-1', form: { data: { turbo_scroll: true, turbo_scroll_container: 'production_body' } }) do %>
    <i class="fa-solid fa-circle-minus fa-xl has-text-dark-grey"></i>
  <% end if trade_item.number > 1 %>
  <%= button_to({ controller: 'trade/my/trade_items', action: 'destroy', id: trade_item.id }, method: :delete, class: 'mr-1', form: { data: { turbo_scroll: true, turbo_scroll_container: 'production_body' } }) do %>
    <i class="fa-solid fa-circle-minus fa-xl has-text-danger-dark"></i>
  <% end if trade_item.number <= 1 %>
  <%= form_with(theme: nil, scope: 'trade_item', url: { controller: 'trade/my/trade_items', action: 'update', id: trade_item.id }, method: :patch, data: { controller: 'input', turbo_scroll: true, turbo_scroll_container: 'production_body' }) do |f| %>
    <%= f.number_field :number, value: trade_item.number, data: { action: 'change->input#form' }, class: 'has-background-light has-text-centered', style: 'width: 30px' %>
  <% end %>
  <%= button_to({ controller: 'trade/my/trade_items', action: 'update', id: trade_item.id }, method: :patch, params: { '[trade_item]number': trade_item.number + 1 }, class: 'ml-1', form: { data: { turbo_scroll: true, turbo_scroll_container: 'production_body' } }) do %>
    <i class="fa-solid fa-circle-plus fa-xl has-text-dark-grey"></i>
  <% end %>
  <span class="has-text-grey pl-2">下单： <%= trade_item.member.name %></span>
<% else %>
  <%= form_with theme: nil, url: { controller: 'trade/into/trade_items', action: 'cost' }, data: { turbo_scroll: true, turbo_scroll_container: 'production_body' }, class: 'button_to' do |f| %>
    <%= f.hidden_field :good_type, value: model.class_name %>
    <%= f.hidden_field :good_id, value: model.id %>
    <%= f.hidden_field :aim, value: 'invest' %>
    <%= button_tag do %>
      <i class="fa-solid fa-circle-plus fa-xl has-text-dark-grey"></i>
    <% end %>
  <% end %>
<% end %>
